<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="jatos.js is a JavaScript library that helps you to communicate from your component's JavaScript with your JATOS server. Below we list and describe the variab...">
<meta name="keywords" content=" reference, jatos.js, function, variable, js, javascript, library">
<title>jatos.js Reference | JATOS 3 Documentation</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="jatos_docs_v3" href="http://localhost:4000/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="Whats-JATOS.html"><span class="projectTitle"><img src="images/jatos_logo_color.svg" height="20">&nbsp;JATOS 3 Documentation</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/JATOS/JATOS/releases/latest" target="_blank">Download</a></li>
                
                
                
                <li><a href="Example-Studies.html" target="_blank">Example Studies</a></li>
                
                
                
                <li><a href="http://blog.jatos.org" target="_blank">Blog</a></li>
                
                
                
                <li><a href="Contact-us.html">Contact</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="jatos.js Reference">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle"> </li>
  
  
  
      
  
  <li>
      <a href="#">Overview</a>
      <ul>
          
          
          
          <li><a href="Whats-JATOS.html">What's JATOS</a></li>
          
          
          
          
          
          
          
          
          <li><a href="Installation.html">Installation</a></li>
          
          
          
          
          
          
          <li><a href="Get-started.html">Get started</a></li>
          
          
          
          
          
          
          <li><a href="Set-up-your-own-studies.html">Set up your own studies</a></li>
          
          
          
          
          
          
          <li><a href="Data-Privacy-and-Ethics.html">Data Privacy and Ethics</a></li>
          
          
          
          
          
          
          <li><a href="JATOS-Tryout-Server.html">JATOS Tryout Server</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Write your study</a>
      <ul>
          
          
          
          <li><a href="Mandatory-lines-in-your-components-HTML.html">Mandatory lines in your components' HTML</a></li>
          
          
          
          
          
          
          <li><a href="Adapt-Pre-written-Code-to-run-it-in-JATOS.html">Adapt Pre written Code to run it in JATOS (Jatosify)</a></li>
          
          
          
          
          
          
          <li><a href="jsPsych-and-JATOS.html">jsPsych and JATOS</a></li>
          
          
          
          
          
          
          <li><a href="labjs-and-JATOS.html">lab.js and JATOS</a></li>
          
          
          
          
          
          
          <li><a href="OSWeb-and-JATOS.html">OSWeb and JATOS</a></li>
          
          
          
          
          
          
          <li><a href="Session-Data-Three-Types.html">Session Data - Three Types</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Run your study</a>
      <ul>
          
          
          
          <li><a href="Run-your-Study-with-Worker-and-Batch-Manager.html">Run your Study with Worker & Batch Manager</a></li>
          
          
          
          
          
          
          <li><a href="Worker-Types.html">Worker Types</a></li>
          
          
          
          
          
          
          <li><a href="Connect-to-Mechanical-Turk.html">Connect to Mechanical Turk</a></li>
          
          
          
          
          
          
          <li><a href="Manage-Results.html">Manage Results</a></li>
          
          
          
          
          
          
          <li><a href="Study-Log.html">Study Log</a></li>
          
          
          
          
          
          
          <li><a href="Tips-and-Tricks.html">Tips & Tricks</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Manage your JATOS</a>
      <ul>
          
          
          
          <li><a href="User-Manager.html">Manage JATOS users</a></li>
          
          
          
          
          
          
          <li><a href="Change-studys-members.html">Change study's members</a></li>
          
          
          
          
          
          
          <li><a href="Update-JATOS.html">Update JATOS</a></li>
          
          
          
          
          
          
          <li><a href="Troubleshooting.html">Troubleshooting</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Group Studies</a>
      <ul>
          
          
          
          <li><a href="Example-Group-Studies.html">Example Group Studies</a></li>
          
          
          
          
          
          
          <li><a href="Write-Group-Studies-I-Setup.html">Write Group Studies I - Setup</a></li>
          
          
          
          
          
          
          <li><a href="Write-Group-Studies-II-JavaScript-and-Messaging.html">Write Group Studies II - JavaScript and Messaging</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Serving the Internet</a>
      <ul>
          
          
          
          <li><a href="Bring-your-JATOS-online.html">Bring your JATOS online</a></li>
          
          
          
          
          
          
          <li><a href="Expose-your-local-JATOS.html">Expose your local JATOS</a></li>
          
          
          
          
          
          
          <li><a href="JATOS-on-DigitalOcean.html">JATOS on DigitalOcean</a></li>
          
          
          
          
          
          
          <li><a href="JATOS-in-Amazons-Cloud-without-Docker.html">JATOS in Amazon's Cloud (without Docker)</a></li>
          
          
          
          
          
          
          <li><a href="JATOS-on-a-server.html">Install JATOS on a server</a></li>
          
          
          
          
          
          
          <li><a href="Configure-JATOS-on-a-Server.html">Configure JATOS on a Server</a></li>
          
          
          
          
          
          
          <li><a href="JATOS-with-Nginx.html">JATOS with Nginx</a></li>
          
          
          
          
          
          
          <li><a href="JATOS-with-Apache.html">JATOS with Apache</a></li>
          
          
          
          
          
          
          <li><a href="Updating-a-JATOS-server-installation.html">Updating a JATOS server installation</a></li>
          
          
          
          
          
          
          <li><a href="Install-JATOS-via-Docker.html">Install JATOS via Docker</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Reference</a>
      <ul>
          
          
          
          <li class="active"><a href="jatos.js-Reference.html">jatos.js Reference</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">jatos.js Reference</h1>
</div>



<div class="post-content">

   
    <div class="summary">jatos.js is a JavaScript library that helps you to communicate from your component's JavaScript with your JATOS server. Below we list and describe the variables and functions of the jatos.js library.</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

    <a target="_blank" href="https://github.com/JATOS/JATOS_docs_v3/blob/gh-pages/pages//jatos.js-Reference.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>

    


    

  <p>Have a look at what’s <a href="Mandatory-lines-in-your-components-HTML.html">mandatory in HTML and JavaScript for JATOS components</a>. Always load the jatos.js script in the <code class="highlighter-rouge">&lt;head&gt;</code> section with the following line:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;script src="jatos.js"&gt;&lt;/script&gt;
</code></pre></div></div>

<p>or in older JATOS versions with:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;script src="/assets/javascripts/jatos.js"&gt;&lt;/script&gt;
</code></pre></div></div>

<p>All variables or calls to jatos.js start with <code class="highlighter-rouge">jatos.</code>. For example, if you want to get the study’s ID you use <code class="highlighter-rouge">jatos.studyId</code>.</p>

<p>And, please, if you find a mistake or have a question don’t hesitate to <a href="Contact-us.html">contact us</a>.</p>

<h2 id="jatosjs-variables">jatos.js variables</h2>

<p>You can call any of these variables below at any point in your HTML file after jatos.js finished initializing (<code class="highlighter-rouge">jatos.onload()</code> will be called). Most variables are read-only. A few variables can be written into (e.g. <code class="highlighter-rouge">jatos.httpTimeout</code>). Those are marked ‘(writeable)’.</p>

<h3 id="ids">IDs</h3>

<p>All those IDs are generated and stored by JATOS. jatos.js automatically sets these variables with the corresponding values if you included the <code class="highlighter-rouge">jatos.onLoad()</code> callback function at the beginning of your JavaScript.</p>

<ul>
  <li><code class="highlighter-rouge">jatos.studyId</code> - ID of the study which is currently running. All the study properties are associated with this ID.</li>
  <li><code class="highlighter-rouge">jatos.componentId</code> - ID of the component which is currently running. All the component properties are associated with this ID.</li>
  <li><code class="highlighter-rouge">jatos.batchId</code> - ID of the batch this study run belongs to. All batch properties are associated with this ID.</li>
  <li><code class="highlighter-rouge">jatos.workerId</code> - Each worker who is running a study has an ID.</li>
  <li><code class="highlighter-rouge">jatos.studyResultId</code> - This ID is individual for every study run. A study result contains data belonging to the run in general (e.g. Study Session).</li>
  <li><code class="highlighter-rouge">jatos.componentResultId</code> - This ID is individual for every component in a study run. A component result contains data of the run belonging to the specific component (e.g. result data).</li>
  <li><code class="highlighter-rouge">jatos.groupMemberId</code> - see <a href="#group-variables">Group Variables</a></li>
  <li><code class="highlighter-rouge">jatos.groupResultId</code> - see <a href="#group-variables">Group Variables</a></li>
</ul>

<p>There’s a convenient function that adds all these IDs to a given object. See function <code class="highlighter-rouge">jatos.addJatosIds(obj)</code> below.</p>

<h3 id="study-variables">Study variables</h3>

<ul>
  <li><code class="highlighter-rouge">jatos.studyProperties</code> - All the properties (except the JSON input data) you entered for this study
    <ul>
      <li><code class="highlighter-rouge">jatos.studyProperties.title</code> - Study’s title</li>
      <li><code class="highlighter-rouge">jatos.studyProperties.uuid</code> - Study’s UUID</li>
      <li><code class="highlighter-rouge">jatos.studyProperties.description</code> - Study’s description</li>
      <li><code class="highlighter-rouge">jatos.studyProperties.descriptionHash</code> - Hash of study’s description</li>
      <li><code class="highlighter-rouge">jatos.studyProperties.locked</code> - Whether the study is locked or not</li>
      <li><code class="highlighter-rouge">jatos.studyProperties.dirName</code> - Study’s dir name in the file system of your JATOS installation</li>
      <li><code class="highlighter-rouge">jatos.studyProperties.groupStudy</code> - Whether this is a group study or not</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">jatos.studyJsonInput</code> - The JSON input you entered in the study’s properties.</li>
  <li><code class="highlighter-rouge">jatos.studyLength</code> - Number of component this study has</li>
</ul>

<h3 id="original-url-query-parameters">Original URL query parameters</h3>

<ul>
  <li>
    <p><code class="highlighter-rouge">jatos.urlQueryParameters</code> - Original query string parameters of the URL that starts the study. It is provided as a JavaScript object. This might be useful to pass on information from outside of JATOS into a study run, e.g. if you want to pass on information like gender and age. However if you know the information beforehand it’s easier to put them in the Study’s or Component’s JSON input. Another example is MTurk which passes on it’s worker’s ID via a URL query parameter.</p>

    <p>Example: One has this link to start a Personal Single Run:</p>

    <p><code class="highlighter-rouge">http://localhost:9000/publix/50/start?batchId=47&amp;personalSingleWorkerId=506</code></p>

    <p>Now one could add parameters to the URL’s query string to pass on external information into the study run. E.g. the following URL would add the parameters ‘foo’ with the value ‘bar’ and ‘a’ with the value ‘123’:</p>

    <p><code class="highlighter-rouge">http://localhost:9000/publix/50/start?batchId=47&amp;personalSingleWorkerId=506&amp;foo=bar&amp;a=123</code></p>

    <p>Then those parameter will be accessible during the study run in <code class="highlighter-rouge">jatos.urlQueryParameters</code> as <code class="highlighter-rouge">{a: "123", foo: "bar"}</code>.</p>

    <p>Example: MTurk uses for its worker ID the URL query parameter ‘workerId’ and this is accessible via <code class="highlighter-rouge">jatos.urlQueryParameters.workerId</code>.</p>
  </li>
</ul>

<h3 id="component-variables">Component variables</h3>

<ul>
  <li><code class="highlighter-rouge">jatos.componentProperties</code> - All the properties (except the JSON input data) you entered for this component
    <ul>
      <li><code class="highlighter-rouge">jatos.componentProperties.title</code> - Component’s title</li>
      <li><code class="highlighter-rouge">jatos.componentProperties.uuid</code> - Component’s UUID</li>
      <li><code class="highlighter-rouge">jatos.componentProperties.htmlFilePath</code> - Path to Component’s HTML file in your JATOS installation</li>
      <li><code class="highlighter-rouge">jatos.componentProperties.reloadable</code> - Whether it’s reloadable</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">jatos.componentJsonInput</code> - The JSON input you entered in the component’s properties.</li>
  <li><code class="highlighter-rouge">jatos.componentList</code> -  An array of all components of this study with basic information about each component. For each component it has the <code class="highlighter-rouge">title</code>, <code class="highlighter-rouge">id</code>, whether it is <code class="highlighter-rouge">active</code>, and whether it is <code class="highlighter-rouge">reloadable</code>.</li>
  <li><code class="highlighter-rouge">jatos.componentPos</code> - Position of this component within the study starting with 1 (like shown in the GUI)</li>
</ul>

<h3 id="studys-session-data">Study’s session data</h3>

<p>The session data can be accessed and modified by every component of a study. It’s a very convenient way to share data between different components. Whatever is written in this variable will be available in the subsequent components. However, remember that the session data will be deleted after the study is finished (see also <a href="Session-Data-Three-Types.html">Session Data - Three Types</a>).</p>

<ul>
  <li><code class="highlighter-rouge">jatos.studySessionData</code> (writeable)</li>
</ul>

<h3 id="batch-variables">Batch variables</h3>

<ul>
  <li><code class="highlighter-rouge">jatos.batchProperties</code> - All the properties you entered for this batch.
    <ul>
      <li><code class="highlighter-rouge">jatos.batchProperties.allowedWorkerTypes</code> - List of worker types that are currently allowed to run in this batch.</li>
      <li><code class="highlighter-rouge">jatos.batchProperties.maxActiveMembers</code> - How many members this group can have at the same time</li>
      <li><code class="highlighter-rouge">jatos.batchProperties.maxTotalMembers</code> - How many members this group is allowed to have at the same time</li>
      <li><code class="highlighter-rouge">jatos.batchProperties.maxTotalWorkers</code> - Total amount of workers this group is allowed to have altogether in this batch</li>
      <li><code class="highlighter-rouge">jatos.batchProperties.title</code> - Title of this batch</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">jatos.batchJsonInput</code> - The JSON input you entered in the batch’s properties.</li>
</ul>

<h3 id="group-variables">Group variables</h3>

<p>The group variables are part of jatos.js since JATOS 2. They are only filled with values if the current study is a group study.</p>

<ul>
  <li><code class="highlighter-rouge">jatos.groupMemberId</code> - Group member ID is unique for this member (it is actually identical with the study result ID)</li>
  <li><code class="highlighter-rouge">jatos.groupResultId</code> - ID of this group result (It’s called group result to be consistent with the study result and the component result - although often it’s just called group)</li>
  <li><code class="highlighter-rouge">jatos.groupState</code> (Removed in JATOS &gt;= v3.4.1) - Represents the state of the group in JATOS; only set if group channel is open (one of STARTED, FIXED, FINISHED)</li>
  <li><code class="highlighter-rouge">jatos.groupMembers</code> - List of member IDs of the current members of the group</li>
  <li><code class="highlighter-rouge">jatos.groupChannels</code> - List of member IDs of the currently open group channels</li>
</ul>

<h3 id="other-variables">Other variables</h3>

<p>All variables can be set except those labled <em>read-only</em>.</p>

<ul>
  <li><code class="highlighter-rouge">jatos.version</code> (<em>read-only</em>) - Current version of the jatos.js library</li>
  <li>
    <p><code class="highlighter-rouge">jatos.channelSendingTimeoutTime</code> - Time in ms to wait for an answer after sending a message via a channel (batch or group). Set this variable if you want to change the default value (default is 10 s).</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">channelSendingTimeoutTime</span> <span class="o">=</span> <span class="mi">20000</span><span class="p">;</span> <span class="c1">// Sets channel timeout to 20 seconds</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">jatos.channelHeartbeatInterval</code> -  Waiting time in ms between channel (group or batch) heartbeats (default is 25 s)</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">channelHeartbeatInterval</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">;</span> <span class="c1">// Sets interval to 10 seconds</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">jatos.channelHeartbeatTimeoutTime</code> - Waiting time in ms for JATOS server’s answer to a channel heartbeat (default is 10 s)</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">channelHeartbeatTimeoutTime</span> <span class="o">=</span> <span class="mi">20000</span><span class="p">;</span> <span class="c1">// Sets interval to 20 seconds</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">jatos.channelClosedCheckInterval</code> - Waiting time in ms between checking if channels (group or batch) are closed unexpectedly (default is 2 s)</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">channelClosedCheckInterval</span> <span class="o">=</span> <span class="mi">4000</span><span class="p">;</span> <span class="c1">// Sets interval to 4 seconds</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">jatos.channelOpeningBackoffTimeMin</code> and <code class="highlighter-rouge">jatos.channelOpeningBackoffTimeMax</code> - Min and max waiting time (in ms) between channel reopening attempts (default is 1s for min and 2 min for max). jatos.js uses an <em>exponential back-off</em> retry pattern for the channels.</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">channelOpeningBackoffTimeMin</span> <span class="o">=</span> <span class="mi">2000</span><span class="p">;</span> <span class="c1">// Sets interval to 2 seconds</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">channelOpeningBackoffTimeMax</span> <span class="o">=</span> <span class="mi">60000</span><span class="p">;</span> <span class="c1">// Sets interval to 1 minute</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">jatos.httpTimeout</code> - Time in ms to wait for an answer of an HTTP request by jatos.js. Set this variable if you want to change the default value (default is 1 min).</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">httpTimeout</span> <span class="o">=</span> <span class="mi">30000</span><span class="p">;</span> <span class="c1">// Sets HTTP timeout to 30 seconds</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">jatos.httpRetry</code> - Some jatos functions (e.g. <code class="highlighter-rouge">jatos.sendResultData</code>) send an Ajax request to the JATOS server. If this request was not successful (e.g. network problems) jatos.js retries it. With this variable one can change the number of retries. The default is 5.</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">httpRetry</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// Attempts 2 retries of failed Ajax requests</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">jatos.httpRetryWait</code> - Same as <code class="highlighter-rouge">jatos.httpRetry</code> but this variable defines the waiting time between the retries. The default is 1000 ms.</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">httpRetryWait</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">;</span> <span class="c1">// Sets Ajax retry waiting time to 5 seconds</span>
</code></pre></div>    </div>
  </li>
  <li><code class="highlighter-rouge">jatos.jQuery</code> (<em>read-only</em>) - You can always use jatos.js own jQuery if you want to save some bandwidth</li>
</ul>

<h2 id="general-jatosjs-functions">General jatos.js functions</h2>

<h3 id="jatosonload"><code class="highlighter-rouge">jatos.onLoad</code></h3>

<p>Defines callback function that jatos.js will call when it’s finished initialising. Only <a href="Mandatory-lines-in-your-components-HTML.html">mandatory</a> call in every component.</p>

<ul>
  <li>@param {function} callback - function to be called after jatos.js’ initialization is done</li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">onLoad</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Start here with your code that uses jatos.js' variables and functions</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="jatosonerror"><code class="highlighter-rouge">jatos.onError</code></h3>

<p>Defines a callback function that is to be called in case jatos.js produces an error.</p>

<ul>
  <li>@param {function} callback - Function to be called in case of an error</li>
</ul>

<p><strong>Example</strong></p>

<p>Show the error message in an alert box:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">onError</span><span class="p">(</span><span class="nx">alert</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="jatoslog"><code class="highlighter-rouge">jatos.log</code></h3>

<p>Sends a message to be logged back to the JATOS server where it will be logged in JATOS’ log file.</p>

<ul>
  <li><em>@param {string} logMsg</em> - The messages to be logged</li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Log this message in JATOS' log file"</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="jatosaddjatosids"><code class="highlighter-rouge">jatos.addJatosIds</code></h3>

<p>Convenience function that adds some <a href="jatos.js-Reference.html#ids">IDs</a> (study ID, study title, batch ID, batch title, component ID, component position, component title, worker ID, study result ID, component result ID, group result ID, group member ID) to the given object.</p>

<ul>
  <li><em>@param {object} obj</em> - Object to which the IDs will be added</li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">addJatosIds</span><span class="p">(</span><span class="nx">resultData</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="jatossetheartbeatperiod"><code class="highlighter-rouge">jatos.setHeartbeatPeriod</code></h3>

<p>Every running component sends regularly a HTTP request (the heartbeat) back to the JATOS server. This signals that it is still running. As soon as the browser tab running the component is closed the heartbeat ceases. The time of the last heartbeat is visible in the GUI, in the study results page in the ‘Last Seen’ row. This way you can easily see if a worker is still running your study or if (and when) he abandonend it. By default the heartbeat period is 2 minutes. By careful not to set the period too low (few seconds or even milliseconds) since it might overload your network or your JATOS server.</p>

<ul>
  <li><em>@param {number} heartbeatPeriod</em> - Time period between two heartbeats in milliseconds</li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">setHeartbeatPeriod</span><span class="p">(</span><span class="mi">60000</span><span class="p">);</span> <span class="c1">// Sets to a heartbeat every minute</span>
</code></pre></div></div>

<h2 id="functions-to-control-study-flow">Functions to control study flow</h2>

<h3 id="jatosstartcomponent"><code class="highlighter-rouge">jatos.startComponent</code></h3>

<p>Finishes the currently running component and starts the component with the given ID. Though often it’s better to use <code class="highlighter-rouge">jatos.startComponentByPos</code> instead because it keeps working even after an export/import of the study into another JATOS. Since v3.3.1 one can additionally send result data back to the JATOS server.</p>

<p>Since v3.4.1 there are two version: with or without message</p>

<ol>
  <li>Without message:
    <ul>
      <li><em>@param {number} componentId</em> - ID of the component to start</li>
      <li><em>@param {optional object} resultData</em> - (JATOS &gt;= v3.3.1) String or object that will be sent as result data. An object will be serialized to JSON (stringify).</li>
      <li><em>@param {optional function} onError</em> - Callback function if fail</li>
    </ul>
  </li>
  <li>With message (since JATOS &gt;= v3.4.1):
    <ul>
      <li><em>@param {number} componentId</em> - ID of the component to start</li>
      <li><em>@param {optional object} resultData</em> - String or object that will be sent as result data. An object will be serialized to JSON (stringify).</li>
      <li><em>@param {optional string} message</em> - Message that should be logged (max 255 chars)</li>
      <li><em>@param {optional function} onError</em> - Callback function if fail</li>
    </ul>
  </li>
</ol>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Jump to component with ID 23</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">startComponent</span><span class="p">(</span><span class="mi">23</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Since v3.3.1: send result data and jump to another component</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">startComponent</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="nx">resultData</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Since v3.4.1: send result data, jump to another component and send a message back that will be visible in JATOS result pages and log</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">startComponent</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="nx">resultData</span><span class="p">,</span> <span class="s2">"everything okay"</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>In versions &lt; v3.3.1 it’s often used together with <code class="highlighter-rouge">jatos.submitResultData</code> to first submit result data back to the JATOS server and afterwards jump to another component</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">submitResultData</span><span class="p">(</span><span class="nx">resultData</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">jatos</span><span class="p">.</span><span class="nx">startComponent</span><span class="p">(</span><span class="mi">23</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosstartcomponentbypos"><code class="highlighter-rouge">jatos.startComponentByPos</code></h3>

<p>Finishes the currently running component and starts the component with the given position. The component position is the count of the component within the study like shown in the study overview page (1st component has position 1, 2nd component position 2, …). Since v3.3.1 one can additionally send result data back to the JATOS server.</p>

<p>Since v3.4.1 there are two versions: with or without message</p>

<ol>
  <li>
    <p>Without message</p>

    <ul>
      <li><em>@param {number} componentPos</em> - Position of the component to start</li>
      <li><em>@param {optional object} resultData</em> - (JATOS &gt;= v3.3.1) String or object that will be sent as result data. An object will be serialized to JSON (stringify).</li>
      <li><em>@param {optional function} onError</em> - Callback function if fail</li>
    </ul>
  </li>
  <li>
    <p>With message (since JATOS &gt;= v3.4.1)</p>

    <ul>
      <li><em>@param {number} componentPos</em> - Position of the component to start
        <ul>
          <li><em>@param {optional object or string} resultData</em> - String or object that will be sent as result data. An object will be serialized to JSON (stringify).</li>
          <li><em>@param {optional string} message</em> - Message that should be logged (max 255 chars)</li>
          <li><em>@param {optional function} onError</em> - Callback function if fail</li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Jump to component in position 3</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">startComponentByPos</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Since v3.3.1: send result data and jump to component with position 3</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">startComponentByPos</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nx">resultData</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Since v3.4.1: send result data, jump to component in position 3 and send a message back that will be visible in JATOS result pages and log</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">startComponentByPos</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nx">resultData</span><span class="p">,</span> <span class="s2">"everything okay"</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>In versions &lt; v3.3.1 it’s often used together with <code class="highlighter-rouge">jatos.submitResultData</code> to first submit result data back to the JATOS server and afterwards jump to component in position 3</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">submitResultData</span><span class="p">(</span><span class="nx">resultData</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">jatos</span><span class="p">.</span><span class="nx">startComponentByPos</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosstartnextcomponent"><code class="highlighter-rouge">jatos.startNextComponent</code></h3>

<p>Finishes the currently running component and starts the next component of this study. The next component is the one with position + 1. The component position is the count of the component within the study like shown in the study overview page (1st component has position 1, 2nd component position 2, …). Since v3.3.1 one can additionally send result data back to the JATOS server.</p>

<p>Since v3.4.1 there are two versions: with or without message</p>

<ol>
  <li>
    <p>Without message</p>

    <ul>
      <li><em>@param {optional object} resultData</em> - (JATOS &gt;= v3.3.1) String or object that will be sent as result data. An object will be serialized to JSON (stringify).</li>
      <li><em>@param {optional function} onError</em> - Callback function if fail</li>
    </ul>
  </li>
  <li>
    <p>With message (since JATOS &gt;= v3.4.1)</p>

    <ul>
      <li><em>@param {optional object or string} resultData</em> - String or object that will be sent as result data. An object will be serialized to JSON (stringify).</li>
      <li><em>@param {optional string} message</em> - Message that should be logged (max 255 chars)</li>
      <li><em>@param {optional function} onError</em> - Callback function if fail</li>
    </ul>
  </li>
</ol>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Jump to the next component</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">startNextComponent</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Since v3.3.1: send result data and jump to the next component</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">startNextComponent</span><span class="p">(</span><span class="nx">resultData</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Since v3.4.1: send result data, jump to the next component and send a message back that will be visible in JATOS result pages and log</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">startNextComponent</span><span class="p">(</span><span class="nx">resultData</span><span class="p">,</span> <span class="s2">"everything okay"</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>In versions &lt; v3.3.1 it’s often used together with <code class="highlighter-rouge">jatos.submitResultData</code> to first submit result data back to the JATOS server and afterwards jump to the next component</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">submitResultData</span><span class="p">(</span><span class="nx">resultData</span><span class="p">,</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">startNextComponent</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosstartlastcomponent"><code class="highlighter-rouge">jatos.startLastComponent</code></h3>

<p>Finishes the current component and starts the last component of this study. If the last component is inactive it starts the component with the highest position that is active. The component position is the count of the component within the study like shown in the study overview page (1st component has position 1, 2nd component position 2, …). Since v3.3.1 one can additionally send result data back to the JATOS server.</p>

<p>Since v3.4.1 there are two versions: with or without message</p>

<ol>
  <li>
    <p>Without message</p>

    <ul>
      <li><em>@param {optional object} resultData</em> - (JATOS &gt;= v3.3.1) String or object that will be sent as result data. An object will be serialized to JSON (stringify).</li>
      <li><em>@param {optional function} onError</em> - Callback function if fail</li>
    </ul>
  </li>
  <li>
    <p>With message (since JATOS &gt;= v3.4.1)</p>

    <ul>
      <li><em>@param {optional object or string} resultData</em> - String or object that will be sent as result data. An object will be serialized to JSON (stringify).</li>
      <li><em>@param {optional string} message</em> - Message that should be logged (max 255 chars)</li>
      <li><em>@param {optional function} onError</em> - Callback function if fail</li>
    </ul>
  </li>
</ol>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Jump to the last component</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">startLastComponent</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Since v3.3.1: send result data and jump to the last component</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">startLastComponent</span><span class="p">(</span><span class="nx">resultData</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Since v3.4.1: send result data, jump to the last component and send a message back that will be visible in JATOS result pages and log</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">startLastComponent</span><span class="p">(</span><span class="nx">resultData</span><span class="p">,</span> <span class="s2">"everything okay"</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>In versions &lt; v3.3.1 it’s often used together with <code class="highlighter-rouge">jatos.submitResultData</code> to first submit result data back to the JATOS server and afterwards jump to the last component</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="s2">"my important result data"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">submitResultData</span><span class="p">(</span><span class="nx">resultData</span><span class="p">,</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">startLastComponent</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosabortstudy"><code class="highlighter-rouge">jatos.abortStudy</code></h3>

<p>Aborts study. All previously submitted result data will be deleted. Afterwards the worker is redirected to the study end page. Data stored in the Batch Session or Group Session are uneffected by this.</p>

<ul>
  <li><em>@param {optional string} message</em> - Message that will be stored together with the study results and is accessible via JATOS’ GUI result pages. The message can be max 255 characters long.</li>
  <li><em>@param {optional boolean} showEndPage</em> - If ‘true’ an end page is shown - if ‘false’ it	behaves like <code class="highlighter-rouge">jatos.endStudyAjax</code>, which means no showing of JATOS’ end page</li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Just abort study</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">abortStudy</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Additionally send a message</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">abortStudy</span><span class="p">(</span><span class="s2">"participant aborted by pressing abort button"</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosabortstudyajax"><code class="highlighter-rouge">jatos.abortStudyAjax</code></h3>

<p>Aborts study with an Ajax call. All previously submitted result data will be deleted. Data stored in the Batch Session or Group Session are uneffected by this. It offers callbacks, either as parameter or via <a href="https://api.jquery.com/deferred.promise/">jQuery.deferred.promise</a>, to signal success or failure in the ending.</p>

<ul>
  <li><em>@param {optional string} message</em> - Message that should be logged</li>
  <li><em>@param {optional function} onSuccess</em> - Function to be called in case of successful submit</li>
  <li><em>@param {optional function} onError</em> - Function to be called in case of error</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Just abort study</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">abortStudyAjax</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Abort study with a message that will be sent back to JATOS and shown in the result page and put in the log</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">abortStudyAjax</span><span class="p">(</span><span class="s2">"Worker clicked Abort button"</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosendstudy"><code class="highlighter-rouge">jatos.endStudy</code></h3>

<p>Ends study. Redirects the worker to study’s end page afterwards.</p>

<p>Since v3.4.1 there are two versions: with and without result data</p>

<ol>
  <li>With result data (since JATOS &gt;= v3.4.1)
    <ul>
      <li><em>@param {optional string or object} resultData</em> - Result data to be sent back	to JATOS server</li>
      <li><em>@param {optional boolean} successful</em> - ‘true’ if study should finish successfully, ‘false’ otherwise. Default is true</li>
      <li><em>@param {optional string} message</em> - Message that will be stored together with the study results and is accessible via JATOS’ GUI result pages. The message can be max 255 characters long</li>
      <li><em>@param {optional boolean} showEndPage</em> - If ‘true’ an end page is shown - if ‘false’ it	behaves like <code class="highlighter-rouge">jatos.endStudyAjax</code>, which means no showing of JATOS’ end page</li>
    </ul>
  </li>
  <li>Without result data
    <ul>
      <li><em>@param {optional boolean} successful</em> - ‘true’ if study should finish successfully, ‘false’ otherwise. Default is true</li>
      <li><em>@param {optional string} message</em> - Message that will be stored together with the study results and is accessible via JATOS’ GUI result pages. The message can be max 255 characters long</li>
      <li><em>@param {optional boolean} showEndPage</em> - If ‘true’ an end page is shown - if ‘false’ it	behaves like <code class="highlighter-rouge">jatos.endStudyAjax</code>, which means no showing of JATOS’ end page</li>
    </ul>
  </li>
</ol>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Just end study</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">endStudy</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>End study and send a message back that will be visible in JATOS result pages and log</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">endStudy</span><span class="p">(</span><span class="s2">"everything worked fine"</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Indicate a failure - leads to study result state FAIL</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">endStudy</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="s2">"internal JS error"</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Send result data and end study (since JATOS &gt;= v3.4.1)</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="na">data</span><span class="p">:</span> <span class="s2">"my important result data"</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">endStudy</span><span class="p">(</span><span class="nx">resultData</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Send result data, end study and send a message back that will be visible in JATOS result pages and log (since JATOS &gt;= v3.4.1)</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="na">data</span><span class="p">:</span> <span class="s2">"my important result data"</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">endStudy</span><span class="p">(</span><span class="nx">resultData</span><span class="p">,</span> <span class="s2">"everything worked fine"</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosendstudyajax"><code class="highlighter-rouge">jatos.endStudyAjax</code></h3>

<p>Ends study with an Ajax call - afterwards the study is not redirected to the JATOS’ end page. It offers callbacks, either as parameter or via <a href="https://api.jquery.com/deferred.promise/">jQuery.deferred.promise</a>, to signal success or failure in the ending.</p>

<ul>
  <li><em>@param {optional boolean} successful</em> - ‘true’ if study should finish successful and the participant should get the confirmation code - ‘false’ otherwise.</li>
  <li><em>@param {optional string} message</em> - Message that will be stored together with the study results and is accessible via JATOS’ GUI result pages. The message can be max 255 characters long.</li>
  <li><em>@param {optional function} onSuccess</em> - Function to be called in case of successful submit</li>
  <li><em>@param {optional function} onError</em> - Function to be called in case of error</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Just end study</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">endStudyAjax</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>End study with a message that will be sent back to JATOS and shown in the result page and put in the log</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">endStudyAjax</span><span class="p">(</span><span class="s2">"everything worked fine"</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Indicate a failure and send a message</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">endStudyAjax</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="s2">"internal JS error"</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="functions-for-study-session-and-result-data">functions for Study Session and result data</h2>

<h3 id="jatossubmitresultdata"><code class="highlighter-rouge">jatos.submitResultData</code></h3>

<p>Posts result data for the currently running component back to the JATOS server. Already stored result data for this component will be <strong>overwritten</strong>. If you want to append result data use <code class="highlighter-rouge">jatos.appendResultData</code> instead. Alternatively you can send result data with functions that jump to another component (e.g. <code class="highlighter-rouge">jatos.startComponent</code>) or end the study (<code class="highlighter-rouge">jatos.endStudy</code>). It offers callbacks, either as parameter or via <a href="https://api.jquery.com/deferred.promise/">jQuery.deferred.promise</a>, to signal success or failure in the transfer.</p>

<ul>
  <li><em>@param {object} resultData</em> - String or object that will be sent as result data. An object will be serialized to JSON.</li>
  <li><em>@param {optional function} onSuccess</em> - Function to be called in case of successful submit</li>
  <li><em>@param {optional function} onError</em> - Function to be called in case of error</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Send result data back to the JATOS server</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="mi">789</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">:</span> <span class="mi">100</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">submitResultData</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">resultData</span><span class="p">));</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Since v3.3.1 it’s possible to leave out the JSON serialization</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="mi">789</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">:</span> <span class="mi">100</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">submitResultData</span><span class="p">(</span><span class="nx">resultData</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>It’s often used together with <code class="highlighter-rouge">jatos.startNextComponent</code> to first submit result data back to the JATOS server and afterwards jump to the next component</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="mi">789</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">:</span> <span class="mi">100</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">submitResultData</span><span class="p">(</span><span class="nx">resultData</span><span class="p">,</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">startNextComponent</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Or together with <code class="highlighter-rouge">jatos.startComponentByPos</code> to start a particular component (here at position 4)</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="mi">789</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">:</span> <span class="mi">100</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">submitResultData</span><span class="p">(</span><span class="nx">resultData</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">startComponentByPos</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Or with jQuery’s <a href="https://api.jquery.com/deferred.then/">then</a> function</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="mi">789</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">:</span> <span class="mi">100</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">submitResultData</span><span class="p">(</span><span class="nx">resultData</span><span class="p">).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'success'</span><span class="p">),</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'error'</span><span class="p">));</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosappendresultdata"><code class="highlighter-rouge">jatos.appendResultData</code></h3>

<p><strong>Since JATOS version &gt;= 3.1.7</strong> - Appends result data to the already posted result data. Contrary to <code class="highlighter-rouge">jatos.submitResultData</code> it does not overwrite the result data. Alternatively you can send result data with functions that jump to another component (e.g. <code class="highlighter-rouge">jatos.startComponent</code>) or end the study (<code class="highlighter-rouge">jatos.endStudy</code>). It offers callbacks, either as parameter or via <a href="https://api.jquery.com/deferred.promise/">jQuery.deferred.promise</a>, to signal success or failure in the transfer. This function can be used several times during an component run to incrementally save result data.</p>

<ul>
  <li><em>@param {string} resultData</em> - String or object that will be sent as result data. An object will be serialized to JSON (stringify).</li>
  <li><em>@param {optional function} onSuccess</em> - Function to be called in case of successful submit</li>
  <li><em>@param {optional function} onError</em> - Function to be called in case of error</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Append result data to the already sent</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="mi">789</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">:</span> <span class="mi">100</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">appendResultData</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">resultData</span><span class="p">));</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Since v3.3.1 it’s possible to leave out the JSON serialization</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="mi">789</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">:</span> <span class="mi">100</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">appendResultData</span><span class="p">(</span><span class="nx">resultData</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>You can use it together with <code class="highlighter-rouge">jatos.startNextComponent</code> to first append result data and afterwards jump to the next component</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="mi">789</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">:</span> <span class="mi">100</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">appendResultData</span><span class="p">(</span><span class="nx">resultData</span><span class="p">,</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">startNextComponent</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Or together with <code class="highlighter-rouge">jatos.startComponentByPos</code> to start a particular component (here at position 4)</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">resultData</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="mi">789</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">:</span> <span class="mi">100</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">appendResultData</span><span class="p">(</span><span class="nx">resultData</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">startComponentByPos</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatossetstudysessiondata"><code class="highlighter-rouge">jatos.setStudySessionData</code></h3>

<p><strong>If you just want to write into the study session, this function is not what you want</strong>. This function sets the study session data and <strong>sends it back to the JATOS server</strong>. If you want to write something into the study session, just write into the <a href="jatos.js-Reference.html#studys-session-data"><code class="highlighter-rouge">jatos.studySessionData</code></a> variable.</p>

<p>Posts Study Session data to the JATOS server. This function is called automatically in the end of a component’s life cycle (it’s called by all jatos.js functions that end a component). So unless you want to store the session data during a component run yourself, <strong>it’s not necessary to call this function manually</strong>. It offers callbacks, either as parameter or via <a href="https://api.jquery.com/deferred.promise/">jQuery.deferred.promise</a>, to signal success or failure in the transfer.</p>

<ul>
  <li><em>@param {object} sessionData</em> - object to be submitted</li>
  <li><em>@param {optional function} onSuccess</em> - Function to be called after this function is finished</li>
  <li><em>@param {optional function} onFail</em> - Function to be called after if this this functions fails</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">studySessionData</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="mi">789</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">:</span> <span class="mi">100</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">setStudySessionData</span><span class="p">(</span><span class="nx">studySessionData</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="functions-to-access-the-batch-session">Functions to access the Batch Session</h2>

<p>The Batch Session is stored in JATOS’ database on the server side (see also <a href="Session-Data-Three-Types.html">Session Data - Three Types</a>). That means that all changes in the Batch Session have to be synchronized between the client and the server. This is done via the batch channel. Therefore all writing functions (<code class="highlighter-rouge">add</code>, <code class="highlighter-rouge">remove</code>, <code class="highlighter-rouge">clear</code>, <code class="highlighter-rouge">replace</code>, <code class="highlighter-rouge">copy</code>, <code class="highlighter-rouge">move</code>, <code class="highlighter-rouge">set</code>, <code class="highlighter-rouge">setAll</code>) can be paired with callback functions that will signal  success or failure in the client-server sync. These callback functions can be either passed as parameters to <code class="highlighter-rouge">jatos.batchSession.[function_name]</code> or via <a href="https://api.jquery.com/deferred.promise/">jQuery.deferred.promise</a>.</p>

<p>On the other side for all reading functions (<code class="highlighter-rouge">get</code>, <code class="highlighter-rouge">find</code>, <code class="highlighter-rouge">getAll</code>, <code class="highlighter-rouge">test</code>) there is no need to sync data between client and server, because jatos.js keeps a copy of the Batch Session locally. Therefore all reading functions do not offer callbacks, because there is no risk of failure of synchronization.</p>

<p>Additionally to the reading and writing functions the calback function <code class="highlighter-rouge">jatos.onBatchSession(callback)</code> offers a way to get notified whenever the Batch Session changes in the JATOS’ database regardless of the origin of the change. This way, you can have the client of each worker react to changes in the batch that were done by another worker in the batch.</p>

<p>Accessing the Batch Session is done via <a href="https://tools.ietf.org/html/rfc6902">JSON Patches (RFC 6902)</a> and 
<a href="https://tools.ietf.org/html/rfc6901">JSON Pointer (RFC 6901)</a>. An introduction can be found under <a href="http://jsonpatch.com/">jsonpatch.com</a>. For JSON Patches jatos.js uses the <a href="https://github.com/Starcounter-Jack/JSON-Patch">JSON-Patch</a> library from Joachim Wester and for JSON Pointers the <a href="https://github.com/alexeykuzmin/jsonpointer.js">jsonpointer.js</a> library from Alexey Kuzmin.</p>

<h3 id="jatosbatchsessionadd"><code class="highlighter-rouge">jatos.batchSession.add</code></h3>

<p>JSON Patch add operation: Adds a value to an object or inserts it into an array. In the case of an array, the value is inserted before the given index. The <code class="highlighter-rouge">-</code> character can be used instead of an index to insert at the end of an array (see <a href="http://jsonpatch.com/">jsonpatch.com</a>). If the path already exists in the Batch Session the value will be overwritten.</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path</li>
  <li><em>@param {object} value</em> - value to be stored</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Add to Batch Session</p>

    <p>If the Batch Session is <code class="highlighter-rouge">{"a": 100}</code> and one calls</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Batch Session is successfully updated the new object is <code class="highlighter-rouge">{"a": 100, "b": 123}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Example with an array: Put the object <code class="highlighter-rouge">{id: 123, name: "Max"}</code> after the second position of the array with the path <code class="highlighter-rouge">/subjects</code></p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">"/subjects/2"</span><span class="p">,</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="s2">"Max"</span><span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Append to the end of an array use <code class="highlighter-rouge">/-</code> after the arrays name:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">"/subjects/-"</span><span class="p">,</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">124</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="s2">"Adam"</span><span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosbatchsessionremove"><code class="highlighter-rouge">jatos.batchSession.remove</code></h3>

<p>JSON Patch remove operation: Removes a value from an object or array (see <a href="http://jsonpatch.com/">jsonpatch.com</a>).</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path to the field that should be removed</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Remove from the Batch Session</p>

    <p>If the Batch Session is <code class="highlighter-rouge">{"a": 100, "b": 123}</code> and one calls</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Batch Session is successfully updated the new object is <code class="highlighter-rouge">{"a": 100}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosbatchsessionreplace"><code class="highlighter-rouge">jatos.batchSession.replace</code></h3>

<p>JSON Patch replace operation: Replaces a value. Equivalent to a ‘remove’ followed by an ‘add’ (see <a href="http://jsonpatch.com/">jsonpatch.com</a>).</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path</li>
  <li><em>@param {object} value</em> - value to be replaced with</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Replace in the Batch Session</p>

    <p>If the Batch Session is <code class="highlighter-rouge">{"a": 100, "b": 123}</code> and one calls</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">,</span> <span class="mi">789</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Batch Session is successfully updated the new object is <code class="highlighter-rouge">{"a": 100, "b": 789}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">,</span> <span class="mi">789</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosbatchsessioncopy"><code class="highlighter-rouge">jatos.batchSession.copy</code></h3>

<p>JSON Patch copy operation: Copies a value from one location to another within the JSON document. Both from and path are JSON Pointers (see <a href="http://jsonpatch.com/">jsonpatch.com</a>).</p>

<ul>
  <li><em>@param {string} from</em> - JSON pointer path to the origin</li>
  <li><em>@param {string} path</em> - JSON pointer path to the target</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Copy within the Batch Session from one location to another</p>

    <p>If the Batch Session is <code class="highlighter-rouge">{"a": "jatos"}</code> and one calls</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="s2">"/b"</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Batch Session is successfully updated the new object is <code class="highlighter-rouge">{"a": "jatos", "b": "jatos"}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="s2">"/b"</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosbatchsessionmove"><code class="highlighter-rouge">jatos.batchSession.move</code></h3>

<p>JSON Patch move operation: Moves a value from one location to the other. Both from and path are JSON Pointers. (see <a href="http://jsonpatch.com/">jsonpatch.com</a>).</p>

<ul>
  <li><em>@param {string} from</em> - JSON pointer path to the origin</li>
  <li><em>@param {string} path</em> - JSON pointer path to the target</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Example</strong></p>

<ol>
  <li>
    <p>Move within the Batch Session from one location to another</p>

    <p>If the Batch Session is <code class="highlighter-rouge">{"a": "jatos"}</code> and one calls</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">move</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="s2">"/b"</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Batch Session is successfully updated the new object is <code class="highlighter-rouge">{"b": "jatos"}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">move</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="s2">"/b"</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosbatchsessionfind"><code class="highlighter-rouge">jatos.batchSession.find</code></h3>

<p>Gets a field in the Batch Session data. Takes a JSON Pointer and returns the matching value. Gets the object from the locally stored copy of the session and does not call the server. Contrary to <code class="highlighter-rouge">jatos.batchSession.get</code> it allows to get values from all levels of the Batch Session’s object tree.</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path</li>
  <li><em>@return {object}</em> - the value that is stored in path</li>
</ul>

<p><strong>Example</strong></p>

<ol>
  <li>
    <p>Find a field in the Batch Session</p>

    <p>If the Batch Session is <code class="highlighter-rouge">{"a": {"a1": "foo", "a2": "bar"}, "b": 999}</code></p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">"/a/a1"</span><span class="p">);</span> <span class="c1">// returns "foo"</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">);</span> <span class="c1">// returns 999</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosbatchsessiondefined"><code class="highlighter-rouge">jatos.batchSession.defined</code></h3>

<p><strong>Since JATOS version &gt;= 3.1.8</strong> - Checks in the Batch Session whether a field under the given path exists. Returns true if the field is defined and false otherwise. It’s equivalent to <code class="highlighter-rouge">!jatos.batchSession.test(path, undefined)</code>.</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path to be checked</li>
  <li><em>@return {boolean}</em> - ‘true’ if the field is defined and ‘false’ otherwise</li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">defined</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">);</span> <span class="c1">// returns true if the pointer '/a' exists</span>
</code></pre></div></div>

<h3 id="jatosbatchsessiontest"><code class="highlighter-rouge">jatos.batchSession.test</code></h3>

<p>JSON Patch test operation: Tests that the specified value is set in the document (see <a href="http://jsonpatch.com/">jsonpatch.com</a>).</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path to be tested</li>
  <li><em>@param {object} value</em> - value to be tested</li>
  <li><em>@return {boolean}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Test if a certain field in the Batch Session has a value</p>

    <p>If the Batch Session is <code class="highlighter-rouge">{"a": 123, "b": {"b1": "flowers", "b2": "animals"}}</code></p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span> <span class="c1">// returns true</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="c1">// returns false</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s2">"/b/b1"</span><span class="p">,</span> <span class="s2">"flowers"</span><span class="p">);</span> <span class="c1">// returns true</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>If you want to know the existence of a path in the Batch Session you can test against <code class="highlighter-rouge">undefined</code>:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s2">"/c"</span><span class="p">,</span> <span class="kc">undefined</span><span class="p">))</span> <span class="p">{</span>
  <span class="c1">// Path "/c" exists</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="c1">// Path "/c" doesn't exist</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosbatchsessionget"><code class="highlighter-rouge">jatos.batchSession.get</code></h3>

<p>Convenience function: like <code class="highlighter-rouge">jatos.batchSession.find</code> but works with a key instead of a JSON Pointer. Therefore it works only on the first level of the session’s object tree. It takes a name of an field within the Batch Session and returns the matching value.  For all other levels of the object tree use jatos.batchSession.find. Gets the object from the locally stored copy of the session and does not call the server.</p>

<ul>
  <li><em>@param {string} name</em> - name of the field</li>
  <li><em>@return {object}</em> - the value that is stored under name</li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Get the value that belongs to a key in the Batch Session</p>

    <p>If the Batch Session is <code class="highlighter-rouge">{"a": 1000, "b": "watermelon"}</code></p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Since the parameter is the key's name and not a path it does not start with a "/"</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s2">"b"</span><span class="p">);</span> <span class="c1">// b is "watermelon"</span>
<span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s2">"c"</span><span class="p">);</span> <span class="c1">// c is undefined</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>With <code class="highlighter-rouge">jatos.batchSession.get</code> you can only access the first level of the object tree - if you want another level use <code class="highlighter-rouge">jatos.batchSession.find</code>. If the Batch Session is <code class="highlighter-rouge">{"a": {"a1": 123, "a2": "watermelon"}}</code></p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a1</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s2">"a1"</span><span class="p">);</span> <span class="c1">// a1 is undefined !!!</span>
<span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s2">"a"</span><span class="p">);</span> <span class="c1">// a is { "a1": 123, "a2": "watermelon" }</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosbatchsessionset"><code class="highlighter-rouge">jatos.batchSession.set</code></h3>

<p>A convenience function for <code class="highlighter-rouge">jatos.batchSession.add</code>. Instead of a JSON Pointer path it accepts a name of the field to be stored (without a slash in front). Therefore it works only on the first level of the Batch Session’s object tree. If the name already exists in the Batch Session the value will be overwritten.</p>

<ul>
  <li><em>@param {string} name</em> - name of the field</li>
  <li><em>@param {object} value</em> - value to be stored</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Set a key and its value in the Batch Session</p>

    <p>If the Batch Session is <code class="highlighter-rouge">{"a": 1234}</code></p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Since the parameter is the key's name and not a path it does not start with a "/"</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"koala"</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Batch Session is successfully updated the new object is <code class="highlighter-rouge">{"a": 1234, "b": "koala"}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"koala"</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosbatchsessiongetall"><code class="highlighter-rouge">jatos.batchSession.getAll</code></h3>

<p>Returns the complete Batch Session data. Gets the object from the locally stored copy of the session and does not call the server.</p>

<ul>
  <li><em>@return {object}</em> Returns the whole Batch Session object</li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">batchSession</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">getAll</span><span class="p">();</span>
</code></pre></div></div>

<h3 id="jatosbatchsessionsetall"><code class="highlighter-rouge">jatos.batchSession.setAll</code></h3>

<p>Replaces the whole session data. If the replacing object is rather large it might be better performance-wise to replace only individual paths. Each session writting involves sending the changes in the session via a JSON Patch to the JATOS server. If the session is large this data transfer can take some time. In this case use other session functions, like ‘set’, ‘add’, or ‘replace’.</p>

<ul>
  <li><em>@param {object} value</em> - value to be stored in the session</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Set the whole Batch Session object</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="s2">"foo"</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">setAll</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span> <span class="c1">// Overwrites the current Batch Session with the object o</span>
</code></pre></div>    </div>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="s2">"foo"</span><span class="p">};</span>
<span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">setAll</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosbatchsessionclear"><code class="highlighter-rouge">jatos.batchSession.clear</code></h3>

<p>Clears the whole Batch Session data and sets it to an empty object <code class="highlighter-rouge">{}</code>.</p>

<ul>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Clear the whole Batch Session</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
</code></pre></div>    </div>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosonbatchsession"><code class="highlighter-rouge">jatos.onBatchSession</code></h3>

<p>Defines a callback function that is called every time the Batch Session changes on the JATOS server side (that includes updates in the session originating from other workers that run the study in parallel).</p>

<p>The callback function has two parameter (before v3.3.1 one parameter):</p>
<ul>
  <li><em>@param {string} path</em> - JSON pointer to the changed field in the Batch Session</li>
  <li><em>@param {string} op</em> - (version &gt;= 3.3.1) JSON patch operation (‘add’, ‘remove’, ‘clear’, …) that was applied</li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Show an alert box whenever something changes in the Batch session</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">onBatchSession</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">op</span><span class="p">){</span>
  <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was updated in path "</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="s2">" with operation "</span> <span class="o">+</span> <span class="nx">op</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">onBatchSession</code> is often used together with <code class="highlighter-rouge">jatos.batchSession.find</code> to get the updated value:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">onBatchSession</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">path</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">changedObj</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">batchSession</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
  <span class="nx">alert</span><span class="p">(</span><span class="s2">"The changed object is "</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">changedObj</span><span class="p">));</span>
<span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="functions-for-group-studies">Functions for group studies</h2>

<h3 id="jatosjoingroup"><code class="highlighter-rouge">jatos.joinGroup</code></h3>

<p>Tries to join a group and if it succeeds opens the group channel (which is mostly a WebSocket). Only if the group channel is open one can exchange data with other group members. As the only parameter this function takes an object that consists of several optional callback functions that will be called by jatos.js when certain group events occur. It returns a <a href="https://api.jquery.com/deferred.promise/">jQuery.deferred.promise</a>, to signal success or failure in joining.</p>

<ul>
  <li><em>@param {object} callbacks</em> - Defining callback functions for group events. All callbacks are optional. These callbacks functions are:
    <ul>
      <li><code class="highlighter-rouge">onOpen</code>: Is called when the group channel is successfully opened</li>
      <li><code class="highlighter-rouge">onClose</code>: Is be called when the group channel is closed</li>
      <li><code class="highlighter-rouge">onError</code>: Is called if an error during opening of the group channel’s WebSocket occurs or if an error is received via the group channel (e.g. the Group Session data couldn’t be updated). If this function is not defined jatos.js will try to call the global <code class="highlighter-rouge">onJatosError</code> function.</li>
      <li><code class="highlighter-rouge">onMessage(msg)</code>: Is called if a message from another group member is received. It gets the message as a parameter.</li>
      <li><code class="highlighter-rouge">onMemberJoin(memberId)</code>: Is called when another member (not the worker running this study) joined the group. It gets the group member ID as a parameter.</li>
      <li><code class="highlighter-rouge">onMemberOpen(memberId)</code>: Is called when another member (not the worker running this study) opened a group channel. It gets the group member ID as a parameter.</li>
      <li><code class="highlighter-rouge">onMemberLeave(memberId)</code>: Is called when another member (not the worker running his study) left the group. It gets the group member ID as a parameter.</li>
      <li><code class="highlighter-rouge">onMemberClose(memberId)</code>: Is called when another member (not the worker running this study) closed his group channel. It gets the group member ID as a parameter.</li>
      <li><code class="highlighter-rouge">onGroupSession(path, op)</code>: Is called every time the Group Session changes on the JATOS server side. It gets two parameters (before v3.3.1 only one): 1) JSON pointer path to the changed field in the Group Session as a parameter, and 2) JSON patch operation.</li>
      <li><code class="highlighter-rouge">onUpdate()</code>: Combines several other callbacks. It’s called if one of the following is called: <code class="highlighter-rouge">onMemberJoin</code>, <code class="highlighter-rouge">onMemberOpen</code>, <code class="highlighter-rouge">onMemberLeave</code>, <code class="highlighter-rouge">onMemberClose</code>, or <code class="highlighter-rouge">onGroupSession</code>.</li>
    </ul>
  </li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Minimal example that joins a group and receives updates via the Group Session</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">joinGroup</span><span class="p">({</span>
  <span class="s2">"onGroupSession"</span><span class="p">:</span> <span class="nx">onGroupSession</span>
<span class="p">});</span>

<span class="kd">function</span> <span class="nx">onGroupSession</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">op</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">changedObj</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
  <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session was updated in path "</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="s2">" with operation "</span> <span class="o">+</span> <span class="nx">op</span> <span class="o">+</span> <span class="s2">" to "</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">changedObj</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Example that defines the <code class="highlighter-rouge">onOpen</code>, <code class="highlighter-rouge">onMemberOpen</code>, and <code class="highlighter-rouge">onMessage</code> callbacks</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">joinGroup</span><span class="p">({</span>
  <span class="s2">"onOpen"</span><span class="p">:</span> <span class="nx">onOpen</span><span class="p">,</span>
  <span class="s2">"onMemberOpen"</span><span class="p">:</span> <span class="nx">onMemberOpen</span><span class="p">,</span>
  <span class="s2">"onMessage"</span><span class="p">:</span> <span class="nx">onMessage</span>
<span class="p">});</span>

<span class="kd">function</span> <span class="nx">onOpen</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="s2">"You joined a group and opened a group channel"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">onMemberOpen</span><span class="p">(</span><span class="nx">memberId</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="s2">"In our group another member (ID "</span> <span class="o">+</span> <span class="nx">memberId</span> <span class="o">+</span> <span class="s2">") opened a group channel"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">onMessage</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="s2">"You received a message: "</span> <span class="o">+</span> <span class="nx">msg</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatossendgroupmsg"><code class="highlighter-rouge">jatos.sendGroupMsg</code></h3>

<p>Sends a message to all group members with an open group channel. Use <code class="highlighter-rouge">jatos.sendGroupMsgTo</code> to send a message to a particular member.</p>

<p>Between group members data can be exchanged in fundamentally two different ways: sendGroupMsg/sendGroupMsgTo or the <a href="#functions-to-access-the-group-session">Group Session</a>. The main difference is that the Group Session is stored in JATOS database on the server side while with sendGroupMsg/sendGroupMsgTo the data are only relayed on the server side but is never stored. E.g. if the worker reloads the page all prior messages sent by sendGroupMsg/sendGroupMsgTo will be lost - on the other side, everything stored in the Group Session will be restored. But this storage of the Group Session in JATOS comes at the cost of being (slightly) slower. Which option to choose depends mostly on your study design. If you expect your workers to have an unreliable Internet connection or to reload the page then you should use the Group Session. If you just want to ‘stream’ current data to other members the use sendGroupMsg/sendGroupMsgTo.</p>

<ul>
  <li><em>@param {object} msg</em> - Any JavaScript object</li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="s2">"Message for every group member"</span><span class="p">;</span> <span class="c1">// Send a text message</span>
   <span class="nx">jatos</span><span class="p">.</span><span class="nx">sendGroupMsg</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>

   <span class="kd">var</span> <span class="nx">objMsg</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"city"</span><span class="p">:</span> <span class="s2">"Berlin"</span><span class="p">,</span> <span class="s2">"population"</span><span class="p">:</span> <span class="mi">3500000</span><span class="p">};</span> <span class="c1">// Send an object</span>
   <span class="nx">jatos</span><span class="p">.</span><span class="nx">sendGroupMsg</span><span class="p">(</span><span class="nx">objMsg</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="jatossendgroupmsgto"><code class="highlighter-rouge">jatos.sendGroupMsgTo</code></h3>

<p>Like <code class="highlighter-rouge">jatos.sendGroupMsg</code> but sends a message to a particular group member specified by the group member ID. You can find a list of all IDs of group members with an open channel <code class="highlighter-rouge">jatos.groupChannels</code>. Alternativally you get member IDs via the <code class="highlighter-rouge">onMemberOpen</code> callback function.</p>

<ul>
  <li><em>@param {string} recipient</em> - Recipient’s group member ID</li>
  <li><em>@param {object} msg</em> - Any JavaScript object</li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Send a message to a group member with ID 1063</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="s2">"Message for group member 1063"</span><span class="p">;</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">sendGroupMsgTo</span><span class="p">(</span><span class="s2">"1063"</span><span class="p">,</span> <span class="nx">msg</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Use the <code class="highlighter-rouge">onMemberOpen</code> callback to send a message right after a new member opened their group channel</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">joinGroup</span><span class="p">({</span>
  <span class="s2">"onMemberOpen"</span><span class="p">:</span> <span class="nx">onMemberOpen</span><span class="p">,</span>
  <span class="s2">"onMessage"</span><span class="p">:</span> <span class="nx">onMessage</span>
<span class="p">});</span>

<span class="kd">function</span> <span class="nx">onMemberOpen</span><span class="p">(</span><span class="nx">memberId</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="s2">"Welcome to the group!"</span><span class="p">;</span>
  <span class="nx">jatos</span><span class="p">.</span><span class="nx">sendGroupMsgTo</span><span class="p">(</span><span class="nx">memberId</span><span class="p">,</span> <span class="nx">msg</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">onMessage</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">alert</span><span class="p">(</span><span class="s2">"You received a message: "</span> <span class="o">+</span> <span class="nx">msg</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosleavegroup"><code class="highlighter-rouge">jatos.leaveGroup</code></h3>

<p>Leaves the group it has previously joined. It offers callbacks, either as parameter or via <a href="https://api.jquery.com/deferred.promise/">jQuery.deferred.promise</a>, to signal success or failure in the leaving.</p>

<ul>
  <li><em>@param {optional function} onSuccess</em> - Function to be called after the group is left</li>
  <li><em>@param {optional function} onError</em> - Function to be called in case of error</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">leaveGroup</span><span class="p">();</span>
</code></pre></div></div>

<h3 id="jatosreassigngroup"><code class="highlighter-rouge">jatos.reassignGroup</code></h3>

<p>Asks the JATOS server to reassign this study run to a different group. JATOS can only reassign if there is another group availible. It offers callbacks, either as parameter or via <a href="https://api.jquery.com/deferred.promise/">jQuery.deferred.promise</a>, to signal success or failure in the reassigning.</p>

<ul>
  <li><em>@param {optional function} onSuccess</em> - Function to be called if the reassignment was successful</li>
  <li><em>@param {optional function} onFail</em> - Function to be called if the reassignment was unsuccessful</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">reassignGroup</span><span class="p">();</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Successful group reassignment: new group ID is "</span> <span class="o">+</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupResultId</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group reassignment failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div></div>

<h3 id="jatossetgroupfixed"><code class="highlighter-rouge">jatos.setGroupFixed</code></h3>

<p>Ask the JATOS server to fix this group. A fixed group is not allowed to take on more members although members are still allowed to leave. It offers callbacks, either as parameter or via <a href="https://api.jquery.com/deferred.promise/">jQuery.deferred.promise</a>, to signal success or failure in the fixing.</p>

<ul>
  <li><em>@param {optional function} onSuccess</em> - Function to be called if the fixing was successful</li>
  <li><em>@param {optional function} onFail</em> - Function to be called if the fixing was unsuccessful</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">setGroupFixed</span><span class="p">();</span>
</code></pre></div></div>

<h3 id="jatoshasjoinedgroup"><code class="highlighter-rouge">jatos.hasJoinedGroup</code></h3>

<p>Returns true if this study run joined a group and false otherwise. It doesn’t necessarily mean that we have an open group channel. We might just have joined a group in a prior component but in this component never opened the channel. If you want to check for an open group channel use <code class="highlighter-rouge">jatos.hasOpenGroupChannel</code>.</p>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="nx">jatos</span><span class="p">.</span><span class="nx">hasJoinedGroup</span><span class="p">())</span> <span class="p">{</span>
  <span class="c1">// We are member in a group</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="c1">// We are not member in a group</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="jatoshasopengroupchannel"><code class="highlighter-rouge">jatos.hasOpenGroupChannel</code></h3>

<p>Returns true if we currently have an open group channel and false otherwise. Since you can’t open a group channel without joining a group, it also means that we joined a group. On the other side although we have closed group channel we can still be a member in a group. Use <code class="highlighter-rouge">jatos.hasJoinedGroup</code> to check group membership.</p>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="nx">jatos</span><span class="p">.</span><span class="nx">hasOpenGroupChannel</span><span class="p">())</span> <span class="p">{</span>
  <span class="c1">// We are member in a group and have an open group channel</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="c1">// We do not have an open group channel (but could still be member in a group)</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="jatosismaxactivememberreached"><code class="highlighter-rouge">jatos.isMaxActiveMemberReached</code></h3>

<p>Returns true if the group has reached the maximum amount of active members like specified in the batch properties. It’s not necessary that each member has an open group channel.</p>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="nx">jatos</span><span class="p">.</span><span class="nx">isMaxActiveMemberReached</span><span class="p">())</span> <span class="p">{</span>
  <span class="c1">// Maximum number of active members is reached</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="jatosismaxactivememberopen"><code class="highlighter-rouge">jatos.isMaxActiveMemberOpen</code></h3>

<p>Returns true if the group has reached the maximum amount of active members like specified in the batch properties and each member has an open group channel.</p>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="nx">jatos</span><span class="p">.</span><span class="nx">isMaxActiveMemberOpen</span><span class="p">())</span> <span class="p">{</span>
  <span class="c1">// Maximum number of active members is reached and each has an open channel</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="jatosisgroupopen"><code class="highlighter-rouge">jatos.isGroupOpen</code></h3>

<p>Returns true if all active members of the group have an open group channel and can send and receive data. It’s not necessary that the group has reached its minimum or maximum active member size.</p>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="nx">jatos</span><span class="p">.</span><span class="nx">isGroupOpen</span><span class="p">())</span> <span class="p">{</span>
  <span class="c1">// Each of the current members of the group have an open group channel</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="functions-to-access-the-group-session">Functions to access the Group Session</h2>

<p>The Group Session is one of three way to communicate between members of a group. The others are direct messaging (with <a href="#jatossendgroupmsgtorecipient-msg">jatos.sendGroupMsgTo</a>) and broadcast messaging (<a href="#jatossendgroupmsgmsg">jatos.sendGroupMsg</a>) (or: <a href="/Session-Data-Three-Types.html">more general information about the different session types</a>).</p>

<p>In difference to the <a href="#functions-to-access-the-batch-session">Batch Session</a> the Group Session doesn’t work from the start of a component. To use the Group Session you have to join a group (<a href="#jatosjoingroupcallbacks">with jatos.joinGroup</a>). There you can also define a <code class="highlighter-rouge">onGroupSession</code> callback that gets called each time the Group Session changes regardless of the origin of the change.</p>

<p>The Group Session is stored in JATOS’ database on the server side. That means that all changes in the Group Session have to be synchronized between the client and the server. This is done via the group channel. Therefore all writing functions (<code class="highlighter-rouge">add</code>, <code class="highlighter-rouge">remove</code>, <code class="highlighter-rouge">clear</code>, <code class="highlighter-rouge">replace</code>, <code class="highlighter-rouge">copy</code>, <code class="highlighter-rouge">move</code>, <code class="highlighter-rouge">set</code>, <code class="highlighter-rouge">setAll</code>) can be paired with callback functions that will signal  success or failure in the client-server sync. These callback functions can be either passed as parameters to <code class="highlighter-rouge">jatos.groupSession.[function_name]</code> or via <a href="https://api.jquery.com/deferred.promise/">jQuery.deferred.promise</a>.</p>

<p>On the other side for all reading functions (<code class="highlighter-rouge">get</code>, <code class="highlighter-rouge">find</code>, <code class="highlighter-rouge">getAll</code>, <code class="highlighter-rouge">test</code>) there is no need to sync data between client and server, because jatos.js keeps a copy of the Group Session locally. Therefore all reading functions do not offer callbacks, because there is no risk of failure of synchronization.</p>

<p>Accessing the Group Session is done via <a href="https://tools.ietf.org/html/rfc6902">JSON Patches (RFC 6902)</a> and 
<a href="https://tools.ietf.org/html/rfc6901">JSON Pointer (RFC 6901)</a>. An introduction can be found under <a href="http://jsonpatch.com/">jsonpatch.com</a>. For JSON Patches jatos.js uses the <a href="https://github.com/Starcounter-Jack/JSON-Patch">JSON-Patch</a> library from Joachim Wester and for JSON Pointers the <a href="https://github.com/alexeykuzmin/jsonpointer.js">jsonpointer.js</a> library from Alexey Kuzmin.</p>

<h3 id="jatosgroupsessionadd"><code class="highlighter-rouge">jatos.groupSession.add</code></h3>

<p>JSON Patch add operation: Adds a value to an object or inserts it into an array. In the case of an array, the value is inserted before the given index. The <code class="highlighter-rouge">-</code> character can be used instead of an index to insert at the end of an array (see <a href="http://jsonpatch.com/">jsonpatch.com</a>). If the path already exists in the Group Session the value will be overwritten.</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path</li>
  <li><em>@param {object} value</em> - value to be stored</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Add an a field to the Group Session</p>

    <p>If the Group Session is <code class="highlighter-rouge">{"a": 100}</code> and one calls</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Group Session is successfully updated the new object is <code class="highlighter-rouge">{"a": 100, "b": 123}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Example with an array: Put the object <code class="highlighter-rouge">{id: 123, name: "Max"}</code> after the second position of the array with the path <code class="highlighter-rouge">/subjects</code>:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">"/subjects/2"</span><span class="p">,</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="s2">"Max"</span><span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Example of how to append to the end of an array: use <code class="highlighter-rouge">/-</code> after the arrays name:</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">"/subjects/-"</span><span class="p">,</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="mi">124</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="s2">"Adam"</span><span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Batch Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosgroupsessionremove"><code class="highlighter-rouge">jatos.groupSession.remove</code></h3>

<p>JSON Patch remove operation: Removes a value from an object or array (see <a href="http://jsonpatch.com/">jsonpatch.com</a>).</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path to the field that should be removed</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Remove a field from the Group Session</p>

    <p>If the Group Session is <code class="highlighter-rouge">{"a": 100, "b": 123}</code> and one calls</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Group Session is successfully updated the new object is <code class="highlighter-rouge">{"a": 100}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosgroupsessionreplace"><code class="highlighter-rouge">jatos.groupSession.replace</code></h3>

<p>JSON Patch replace operation: Replaces a value. Equivalent to a “remove” followed by an “add” (see <a href="http://jsonpatch.com/">jsonpatch.com</a>).</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path</li>
  <li><em>@param {object} value</em> - value to be replaced with</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Replace a field in the Group Session</p>

    <p>If the Group Session is <code class="highlighter-rouge">{"a": 100, "b": 123}</code> and one calls</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">,</span> <span class="mi">789</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Group Session is successfully updated the new object is <code class="highlighter-rouge">{"a": 100, "b": 789}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">,</span> <span class="mi">789</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosgroupsessioncopy"><code class="highlighter-rouge">jatos.groupSession.copy</code></h3>

<p>JSON Patch copy operation: Copies a value from one location to another within the JSON document. Both from and path are JSON Pointers (see <a href="http://jsonpatch.com/">jsonpatch.com</a>).</p>

<ul>
  <li><em>@param {string} from</em> - JSON pointer path to the origin</li>
  <li><em>@param {string} path</em> - JSON pointer path to the target</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Copy a field in the Group Session from one location to another</p>

    <p>If the Group Session is <code class="highlighter-rouge">{"a": "jatos"}</code> and one calls</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="s2">"/b"</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Group Session is successfully updated the new object is <code class="highlighter-rouge">{"a": "jatos", "b": "jatos"}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="s2">"/b"</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosgroupsessionmove"><code class="highlighter-rouge">jatos.groupSession.move</code></h3>

<p>JSON Patch move operation: Moves a value from one location to the other. Both from and path are JSON Pointers. (see <a href="http://jsonpatch.com/">jsonpatch.com</a>).</p>

<ul>
  <li><em>@param {string} from</em> - JSON pointer path to the origin</li>
  <li><em>@param {string} path</em> - JSON pointer path to the target</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Move a field in the Group Session from one location to another</p>

    <p>If the Group Session is <code class="highlighter-rouge">{"a": "jatos"}</code> and one calls</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">move</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="s2">"/b"</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Group Session is successfully updated the new object is <code class="highlighter-rouge">{"b": "jatos"}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">move</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="s2">"/b"</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosgroupsessionfind"><code class="highlighter-rouge">jatos.groupSession.find</code></h3>

<p>Gets a field in the Group Session data. Takes a JSON Pointer and returns the matching value. Gets the object from the locally stored copy of the session and does not call the server. Contrary to <code class="highlighter-rouge">jatos.groupSession.get</code> it allows to get values from all levels of the Group Session’s object tree.</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path</li>
  <li><em>@return {object}</em> - the value that is stored in path</li>
</ul>

<p><strong>Example</strong></p>

<p>Given the Group Session is <code class="highlighter-rouge">{"a": {"a1": "foo", "a2": "bar"}, "b": 999}</code></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">"/a/a1"</span><span class="p">);</span> <span class="c1">// returns "foo"</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">"/b"</span><span class="p">);</span> <span class="c1">// returns 999</span>
</code></pre></div></div>

<p>the first line returns “foo” and the second 999.</p>

<h3 id="jatosgroupsessiondefined"><code class="highlighter-rouge">jatos.groupSession.defined</code></h3>

<p><strong>Since JATOS version &gt;= 3.1.8</strong> - Checks in the Group Session whether a field under the given path exists. Returns true if the field is defined and false otherwise. It’s equivalent to <code class="highlighter-rouge">!jatos.groupSession.test(path, undefined)</code>.</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path to be checked</li>
  <li><em>@return {boolean}</em></li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">defined</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">);</span> <span class="c1">// returns true if the pointer '/a' exists</span>
</code></pre></div></div>

<h3 id="jatosgroupsessiontest"><code class="highlighter-rouge">jatos.groupSession.test</code></h3>

<p>JSON Patch test operation: Tests that the specified value is set in the document (see <a href="http://jsonpatch.com/">jsonpatch.com</a>).</p>

<ul>
  <li><em>@param {string} path</em> - JSON pointer path to be tested</li>
  <li><em>@param {object} value</em> - value to be tested</li>
  <li><em>@return {boolean}</em></li>
</ul>

<p><strong>Example</strong></p>

<p>Given the Group Session is <code class="highlighter-rouge">{"a": 123, "b": {"b1": "flowers", "b2": "animals"}}</code></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span> <span class="c1">// returns true</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s2">"/a"</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="c1">// returns false</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="s2">"/b/b1"</span><span class="p">,</span> <span class="s2">"flowers"</span><span class="p">);</span> <span class="c1">// returns true</span>
</code></pre></div></div>

<p>the first line returns true, second false and third true.</p>

<h3 id="jatosgroupsessionget"><code class="highlighter-rouge">jatos.groupSession.get</code></h3>

<p>Convenience function: like <code class="highlighter-rouge">jatos.groupSession.find</code> but works with a key instead of a JSON Pointer (without the slash in front of the key name). Therefore it works only on the first level of the session’s object tree. It takes a name of an field within the Group Session and returns the matching value.  For all other levels of the object tree use jatos.groupSession.find. Gets the object from the locally stored copy of the session and does not call the server.</p>

<ul>
  <li><em>@param {string} name</em> - name of the field</li>
  <li><em>@return {object}</em> - the value that is stored under name</li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Get a field from the Group Session</p>

    <p>Given the Group Session is <code class="highlighter-rouge">{"a": 1000, "b": "watermelon"}</code></p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Since the parameter is the key's name and not a path it does not start with a "/"</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s2">"b"</span><span class="p">);</span> <span class="c1">// b is "watermelon"</span>
<span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s2">"c"</span><span class="p">);</span> <span class="c1">// c is undefined</span>
</code></pre></div>    </div>

    <p>the first line returns “watermelon” and the second undefined.</p>
  </li>
  <li>
    <p>With <code class="highlighter-rouge">jatos.groupSession.get</code> you can only access the first level of the object tree - if you want another level use <code class="highlighter-rouge">jatos.groupSession.find</code>.</p>

    <p>If the Group Session is <code class="highlighter-rouge">{"a": {"a1": 123, "a2": "watermelon"}}</code></p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a1</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s2">"a1"</span><span class="p">);</span> <span class="c1">// a1 is undefined !!!</span>
<span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s2">"a"</span><span class="p">);</span> <span class="c1">// a is { "a1": 123, "a2": "watermelon" }</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosgroupsessionset"><code class="highlighter-rouge">jatos.groupSession.set</code></h3>

<p>A convenience function for <code class="highlighter-rouge">jatos.groupSession.add</code>. Instead of a JSON Pointer path it accepts a name of the field to be stored (without the slash in front). Therefore it works only on the first level of the Group Session’s object tree. If the name already exists in the Group Session the value will be overwritten.</p>

<ul>
  <li><em>@param {string} name</em> - name of the field</li>
  <li><em>@param {object} value</em> - value to be stored</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Set a field in the Group Session</p>

    <p>If the Group Session is <code class="highlighter-rouge">{"a": 1234}</code></p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Since the parameter is the key's name and not a path it does not start with a "/"</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"koala"</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>then after the Group Session is successfully updated the new object is <code class="highlighter-rouge">{"a": 1234, "b": "koala"}</code>.</p>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="s2">"b"</span><span class="p">,</span> <span class="s2">"koala"</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosgroupsessiongetall"><code class="highlighter-rouge">jatos.groupSession.getAll</code></h3>

<p>Returns the complete Group Session data (might be bad performance-wise). Gets the object from the locally stored copy of the session and does not call the server.</p>

<ul>
  <li><em>@return {object}</em> Returns the whole Group Session object</li>
</ul>

<p><strong>Example</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">groupSession</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">getAll</span><span class="p">();</span>
</code></pre></div></div>

<h3 id="jatosgroupsessionsetall"><code class="highlighter-rouge">jatos.groupSession.setAll</code></h3>

<p>Replaces the whole session data. If the replacing object is rather large it might be better performance-wise to replace only individual paths. Each session writting involves sending the changes in the session via a JSON Patch to the JATOS server. If the session is large this data transfer can take some time. In this case use other session functions, like ‘set’, ‘add’, or ‘replace’.</p>

<ul>
  <li><em>@param {object} value</em> - value to be stored in the session</li>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Set the whole Group Session at once</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="s2">"foo"</span><span class="p">};</span>
<span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">setAll</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span> <span class="c1">// Overwrites the current Group Session with the object o</span>
</code></pre></div>    </div>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"a"</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">:</span> <span class="s2">"foo"</span><span class="p">};</span>
<span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">setAll</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="jatosgroupsessionclear"><code class="highlighter-rouge">jatos.groupSession.clear</code></h3>

<p>Clears the whole Group Session data and sets it to an empty object <code class="highlighter-rouge">{}</code>.</p>

<ul>
  <li><em>@param {optional callback} onSuccess</em> - Function to be called if this patch was successfully applied on the server and the client side</li>
  <li><em>@param {optional callback} onError</em> - Function to be called if this patch failed</li>
  <li><em>@return {jQuery.deferred.promise}</em></li>
</ul>

<p><strong>Examples</strong></p>

<ol>
  <li>
    <p>Clear the whole Group Session</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
</code></pre></div>    </div>

    <p>Since there is a slight chance that the session update was not successful it’s a good idea to provide callback functions for both cases. To provide success or fail callback functions you can either specify the onSuccess/onError parameters or use <a href="https://api.jquery.com/deferred.promise/">jQuery’ deferred object</a>.</p>
  </li>
  <li>
    <p>Catch failures with jQuery’s defered</p>

    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">deferred</span> <span class="o">=</span> <span class="nx">jatos</span><span class="p">.</span><span class="nx">groupSession</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">done</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session was successfully updated"</span><span class="p">)</span> <span class="p">});</span>
<span class="nx">deferred</span><span class="p">.</span><span class="nx">fail</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Group Session synchronization failed"</span><span class="p">)</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ol>


    <div class="tags">
        
    </div>




</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
<span>Page last updated:</span> 15 Nov 2019
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-57013276-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


</html>
